<!DOCTYPE html>

<html lang="en">

<head>
  
  <title>react的钩子函数 - Hexo</title>
  <meta charset="UTF-8">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  
  

  <link rel="shortcut icon" href="/favicon.ico" type="image/png" />
  <meta name="description" content="关于用到的react钩子函数的理解与总结">
<meta property="og:type" content="article">
<meta property="og:title" content="react的钩子函数">
<meta property="og:url" content="http://example.com/2019/09/11/react%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="关于用到的react钩子函数的理解与总结">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-09-11T03:24:36.000Z">
<meta property="article:modified_time" content="2021-03-11T08:03:43.372Z">
<meta property="article:author" content="BlackGarland">
<meta name="twitter:card" content="summary">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/highlight.js@9.15.8/styles/atom-one-dark.css,gh/theme-nexmoe/hexo-theme-nexmoe@latest/source/lib/mdui_043tiny/css/mdui.css,gh/theme-nexmoe/hexo-theme-nexmoe@latest/source/lib/iconfont/iconfont.css,gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css?v=233" crossorigin>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css">
  
  <link rel="stylesheet" href="/css/style.css?v=1615530538008">
<meta name="generator" content="Hexo 5.2.0"><link rel="stylesheet" href="/css/prism-coy.css" type="text/css"></head>

<body class="mdui-drawer-body-left">
  
  <div id="nexmoe-background">
    <div class="nexmoe-bg" style="background-image: url(https://cdn.jsdelivr.net/gh/nexmoe/nexmoe.github.io@latest/images/cover/5c3aec85a4343.jpg)"></div>
    <div class="mdui-appbar mdui-shadow-0">
      <div class="mdui-toolbar">
        <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
        <div class="mdui-toolbar-spacer"></div>
        <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
        <a href="/" title="BlackGarland" class="mdui-btn mdui-btn-icon"><img src="http://pic1.win4000.com/wallpaper/8/597948c99648d.jpg" alt="BlackGarland"></a>
       </div>
    </div>
  </div>
  <div id="nexmoe-header">
      <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="BlackGarland">
            <img src="http://pic1.win4000.com/wallpaper/8/597948c99648d.jpg" alt="BlackGarland" alt="BlackGarland">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>Articles</span>7</div>
        <div><span>Tags</span>0</div>
        <div><span>Categories</span>0</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/about.html" title="关于博客">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博客
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
  
  <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
        <form id="search_form" action_e="https://cn.bing.com/search?q=site:nexmoe.com" onsubmit="return search();">
            <label><input id="search_value" name="q" type="search" placeholder="Search"></label>
        </form>
    </div>
</div>
  
  <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://jq.qq.com/?_wv=1027&k=5CfKHun" target="_blank" mdui-tooltip="{content: 'QQ群'}" style="color: rgb(249, 174, 8);background-color: rgba(249, 174, 8, .1);">
            <i class="nexmoefont icon-QQ"></i>
        </a><a class="mdui-ripple" href="https://space.bilibili.com/160195236/" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/nexmoe/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
  
  

  
  
  
</aside>
    <div class="nexmoe-copyright">
        &copy; 2021 BlackGarland
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        
    </div>
</div><!-- .nexmoe-drawer -->
  </div>
  <div id="nexmoe-content">
    <div class="nexmoe-primary">
        <div class="nexmoe-post">
  
      <div class="nexmoe-post-cover" style="padding-bottom: 62.5%;"> 
          <img data-src="https://pic.netbian.com/uploads/allimg/170725/103840-150095032034c0.jpg" data-sizes="auto" alt="react的钩子函数" class="lazyload">
          <h1>react的钩子函数</h1>
      </div>
  
  
  <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2019年09月11日</a>
    <a><i class="nexmoefont icon-areachart"></i>1,170 字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>大概 4 分钟</a>
</div>

  <div class="nexmoe-post-right">
    
  </div>

  <article>
    <p>关于用到的react钩子函数的理解与总结</p>
<a id="more"></a>
<h2 id="1-react中的钩子函数">1.react中的钩子函数</h2>
<p>参考资料链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e7f7967f8928">https://www.jianshu.com/p/e7f7967f8928</a></p>
<h3 id="1-constructor-props-context">1.constructor(props, context)</h3>
<p>构造函数，在创建组件的时候调用一次</p>
<h3 id="2-componentWillMount">2.componentWillMount()</h3>
<p>componentWillMount()在render之前，componentDidMount（） 在render之后**</p>
<p>在组件render之前立即调用</p>
<p>不建议在此请求数据，由于请求数据接口一般都是异步，这时候render已经被执行，建议在componentDidMount 数据</p>
<p>如果在服务端渲染，该钩子函数将被调用两次，一次服务端，一次浏览器端，而componentDidMount函数只会在浏览器端请求一次</p>
<p>在taro构建的小程序里对应的生命周期是 onLoad。</p>
<h3 id="3-componentDidMount">3.componentDidMount()</h3>
<p>所有的组件（包括子组件）在render执行完之后立即调用，并且只会被调用一次。</p>
<p>请求数据一般在这里</p>
<h3 id="4-componentWillReceiveProps-nextProps">4.componentWillReceiveProps(nextProps)</h3>
<ul>
<li>在props被改变时被触发，初始化render时不调用。</li>
<li>旧的属性还是可以通过this.props来获取，在这里通过调用this.setState()来更新你的组件状态。</li>
</ul>
<p>某些情况下，props没变也会触发该钩子函数，需要在方法里手动判断一下this.props和nextProps是否相同，不相同了才执行我的更新方法。</p>
<p>该函数一般用来更新依赖props的状态</p>
<h3 id="5-shouldComponentUpdate-nextProps-nextState">5. shouldComponentUpdate(nextProps, nextState)</h3>
<ul>
<li>发生重渲染时，在render()函数调用前被调用的函数，当函数返回false时候，阻止接下来的render()函数的调用，阻止组件重渲染，而返回true时，组件照常重渲染。</li>
<li>该方法并不会在初始化渲染或当使用forceUpdate()时被调用。</li>
</ul>
<h3 id="6-componentWillUpdate-nextProps-nextState">6.componentWillUpdate(nextProps, nextState)</h3>
<ul>
<li>shouldComponentUpdate返回true或者调用forceUpdate之后，componentWillUpdate会被调用。</li>
</ul>
<h3 id="7-getSnapshotBeforeUpdate-prevProps-prevState">7. getSnapshotBeforeUpdate(prevProps, prevState)</h3>
<ul>
<li>该函数在最新的渲染输出提交给DOM前将会立即调用。它让你的组件能在当前的值可能要改变前获得它们。这一生命周期返回的任何值将会 作为参数被传递给componentDidUpdate()。</li>
</ul>
<h3 id="8-componentDidUpdate-prevProps-prevState">8. componentDidUpdate(prevProps, prevState)</h3>
<ul>
<li>除了首次render之后调用componentDidMount，其它render结束之后都是调用componentDidUpdate。</li>
</ul>
<h3 id="9-componentWillUnmount">9.componentWillUnmount()</h3>
<ul>
<li>在组件被卸载和销毁之前立刻调用。可以在该方法里处理任何必要的清理工作，例如解绑定时器，取消网络请求，清理任何在componentDidMount环节创建的DOM元素。</li>
</ul>
<h3 id="10-componentDidCatch-error-info">10.componentDidCatch(error, info)</h3>
<ul>
<li>该函数称为错误边界，捕捉发生在子组件树中任意地方的JavaScript错误，打印错误日志，并且显示回退的用户界面。</li>
</ul>
<p><code>Tip</code>：错误边界只捕捉树中发生在它们之下组件里的错误。一个错误边界并不能捕捉它自己内部的错误。</p>
<h3 id="11-render">11.render()</h3>
<p>render是一个React组件所必不可少的核心函数（上面的其它函数都不是必须的）。</p>
<p>页面的代码是放在render里面的，render不能修改state数据。</p>
<h2 id="2-我在react项目中用到的钩子函数及理解">2.我在react项目中用到的钩子函数及理解</h2>
<p>在前几天的毕业设计项目中，用到了一些钩子函数。react大部分钩子函数并不经常用到，对于我来说，钩子函数中主要用到的东西是以下几点：</p>
<ul>
<li>向服务器请求数据</li>
<li>页面渲染后调用方法，比如进入页面自动触发点击事件</li>
<li>监听页面变化，实时动态跟新页面</li>
<li>页面拦截，权限认证</li>
<li>设置state数据</li>
</ul>
<p>这几种方法基本包括了我在项目中用钩子函数做的大部分事情，而众多钩子函数中最普遍的还是这个：</p>
<ul>
<li>render()</li>
<li>componentDidMount()</li>
<li>constructor(props, context)</li>
<li>componentDidUpdate</li>
</ul>
<p>如果我需要页面进入时从服务器请求数据，那么就要用componentDidMount()，把请求放在里面。除此之外，还可以做一些其他的事情比如这样：</p>
<p>我想在页面进入时就开始监听页面滚动数据，当下滚超过200，就把顶部导航栏变窄，显示侧边悬浮栏。页面进入时执行sendRequest方法</p>
<pre><code>componentDidMount() &#123;
		//监听页面滚动数据
        window.addEventListener('scroll', this.HandleScroll);
        //执行自定义的sendRequest方法
        this.sendRequest()

    &#125;
</code></pre>
<p>componentDidUpdate()可以用来动态更新页面，比如父组件传一个数据给子组件，子组件中可以动态改变数据</p>
<pre><code>componentDidUpdate(prevProps) &#123;
        if (this.props.test != prevProps.test) &#123;
            this.setState(&#123;
                test: this.props.test,
            &#125;);
        &#125;
    &#125;
</code></pre>
<p>也可以利用钩子函数操作getDerivedStateFromProps更新state，不过进行一些数据请求的话并且对请求的数据进行数据处理，那么这个函数的显示很累赘，假如写一个方法然后进行this调用，结果这个钩子又不能使用this，</p>

  </article>

  
    
  <div class="nexmoe-post-copyright">
    <strong>Author：</strong>BlackGarland<br>
    <strong>Link：</strong><a href="http://example.com/2019/09/11/react%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0/" title="http:&#x2F;&#x2F;example.com&#x2F;2019&#x2F;09&#x2F;11&#x2F;react%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0&#x2F;" target="_blank" rel="noopener">http:&#x2F;&#x2F;example.com&#x2F;2019&#x2F;09&#x2F;11&#x2F;react%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0&#x2F;</a><br>
    
      <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可
    
  </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
    
    
</div>

  <div class="nexmoe-post-footer">
    <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.5.0/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@1.5.0/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: '80b2453b6d5f37ad6225',
        clientSecret: '43e99fa852795c9a7b3eb924b2558c64b84bbdeb',
        id: window.location.pathname,
        repo: 'nexmoe.github.io',
        owner: 'nexmoe',
        admin: 'nexmoe'
    })
    gitalk.render('gitalk')
</script>
</section>
  </div>
</div>
        <div class="nexmoe-post-right">
          <div class="nexmoe-fixed">
            <div class="nexmoe-tool">
              <a href="#nexmoe-content" class="toc-link" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
            </div>
          </div>
        </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/combine/npm/lazysizes@5.1.0/lazysizes.min.js,gh/highlightjs/cdn-release@9.15.8/build/highlight.min.js,npm/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>
<script>
	hljs.initHighlightingOnLoad();
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>


<script src="https://cdn.jsdelivr.net/gh/xtaodada/xtaodada.github.io@0.0.2/copy.js"></script>
 <script src="/js/app.js?v=1615530538008"></script>

<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>

  





<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/haru02.model.json"},"display":{"position":"right","width":300,"height":600},"mobile":{"show":false},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>
